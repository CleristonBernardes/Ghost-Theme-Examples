{{! Previous/next page links - only displayed on page 2+ }}
<div class="extra-pagination inner">
    {{pagination}}
</div>

{{! This is the post loop - each post will be output using this markup }}
{{#foreach posts}}
<article class="{{post_class}}">
    <header class="post-header">
        <h2 class="post-title"><a href="{{url}}">{{{title}}}</a></h2>
    </header>
    <section class="post-excerpt">
        <p>{{excerpt words="26"}} <a class="read-more" href="{{url}}">&raquo;</a></p>
    </section>
    <footer class="post-meta">
        {{#if author.image}}<img class="author-thumb" src="{{author.image}}" alt="{{author.name}}" nopin="nopin" />{{/if}}
        {{author}}
        {{tags prefix=" on "}}
        <time class="post-date" datetime="{{date format='YYYY-MM-DD'}}">{{date format="DD MMMM YYYY"}}</time>
    </footer>
</article>
{{/foreach}}

{{! Previous/next page links - displayed on every page }}
{{!-- {{pagination}} --}}

<script>
$(document).ready(function () {
    var apiUrl = window.location.href + '/ghost/api/v0.1/',
            clientId = $('[property="ghost:client_id"]').attr('content'),
            clientSecret = $('[property="ghost:client_secret"]').attr('content'),
            nextPage = 2,
            pagination = 1;

    $('#load-posts').click(function() {
        $.ajax({
            url: apiUrl + 'posts/?limit=' + pagination + '&page=' + nextPage + '&client_id=' + clientId + '&client_secret=' + clientSecret,
            type: 'get'
        }).done(function (data) {
          $.each(data.posts, function(i, post) {
            insertPost(post);
          }); 
        }).fail(function (err){
          console.log(err);
        });
    })

    function insertPost(postData) {
        console.log(postData);
        $('#content').append(
            '<article class="post">\
                <header class="post-header">\
                    <h2 class="post-title"><a href="' + postData.url + '">' + postData.title + '</a></h2>\
                </header>\
                <section class="post-excerpt">\
                    <p>' + postData.markdown +  '<a class="read-more" href="' + postData.url + '">&raquo;</a></p>\
                </section>\
                <footer class="post-meta">\
                    {{#if author.image}}<img class="author-thumb" src="{{author.image}}" alt="{{author.name}}" nopin="nopin" />{{/if}}\
                    {{author}}\
                    {{tags prefix=" on "}}\
                    <time class="post-date" datetime="{{date format='YYYY-MM-DD'}}">{{date format="DD MMMM YYYY"}}</time>\
                </footer>\
            </article>'
        )
        nextPage += 1;
    }
});
</script>